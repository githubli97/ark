# 方舟idaas

| 场景名称     | 锁     | 场景动作         | 域   | 域服务                                                                                                                    | 聚合根 | 方法    |
|----------|-------|--------------|-----|------------------------------------------------------------------------------------------------------------------------|-----|-------|
| 创建协同单    | 无     | 判断关联业务单是否非法  | 协同单 | 1. 问题分类是否符合条件(例如:商家用户发起自营->商家的协同单)  <br/> 2. save                                                                      | 协同单 | 创建协同单 |
| 分配协同单    | 协同单ID | 分配协同单到人.     | 协同单 | 1. 判断协同单状态(=待处理)  <br/> 2. 记录操作日志  <br/> 3. save                                                                       | 协同单 | 分配协同单 |
| 受理协同单    | 协同单ID | 处理协同单        | 协同单 | 1. 判断订单状态(=待处理/验收失败)  <br/> 2. 更改订单状态（待处理/验收失败->处理中）  <br/> 3. 记录操作日志  <br/> 4. save                                   | 协同单 | 受理协同单 |
| 转交协同单    | 协同单ID | 转交协同单        | 协同单 | 1. 判断订单状态.（=处理中、待处理）  <br/> 2. 校验转交的人是否在正确的组织下面  <br/> 3. 更改协同人值对象（同一组织下的不同人，从坐席管理域中取）  <br/> 4. 记录操作日志  <br/> 5. save | 协同单 | 转交协同单 |
| 关闭协同单    | 协同单ID | 关闭协同单        | 协同单 | 1. 判断订单状态(=处理中、待处理)  <br/> 2. 更改订单状态(关闭)  <br/> 3. 记录操作日志  <br/> 4. save                                               | 协同单 | 关闭协同单 |
| 处理协同单    | 协同单ID | 处理协同单        | 协同单 | 1. 判断订单状态(=处理中)  <br/> 2. 更改订单状态(处理中->待验收)  <br/> 3. 记录操作日志  <br/> 4. save                                             | 协同单 | 处理协同单 |
| 驳回协同单    | 协同单ID | 驳回协同单        | 协同单 | 1. 判断订单状态(=待验收)  <br/> 2. 更改订单状态(待验收->处理中)  <br/> 3. 记录操作日志  <br/> 4. save                                             | 协同单 | 驳回协同单 |
| 完结协同单    | 协同单ID | 完结协同单        | 协同单 | 1. 判断订单状态(=待验收)  <br/> 2. 更改订单状态(待验收->已完结)  <br/> 3. 记录操作日志  <br/> 4. save                                             | 协同单 | 完结协同单 |
| 拒绝协同单    | 协同单ID | 拒绝协同单        | 协同单 | 1. 判断订单状态(=处理中、待处理)  <br/> 2. 更改订单状态(已拒绝)  <br/> 3. 记录操作日志  <br/> 4. save                                              | 协同单 | 拒绝协同单 |
| 催单       | 协同单ID | 催单           | 协同单 | 1. 判断订单状态(=处理中、待处理)  <br/> 2. 修改催单值对象  <br/> 3. 记录操作日志  <br/> 4. save                                                  | 协同单 | 催单    |
| 注册       | 无     | 判断验证码是否一致    | 账号  | 1.手机号是否已经注册<br/>2.                                                                                                     |     |       |    
| 验证码登录    | 无     | 判断验证码是否一致    | 账号  |                                                                                                                        |     |       |
| 注销       | 账号id  | 判断用户是否在登录状态  | 账号  |                                                                                                                        |     |       |
| 重置密码     | 账号id  | 判断验证码是否一致    | 账号  |                                                                                                                        |     |       |
| 绑定邮箱     | 账号id  | 判断邮箱验证码是否一致  | 账号  |                                                                                                                        |     |       |
| 绑定github | 账号id  | 判断github是否授权 | 账号  |                                                                                                                        |     |       |

##

账号Account
### 手机号注册账户

### 短信验证码登录

### 注销

### 重置密码

### 绑定邮箱

### 绑定GitHub

用户User

### 用户注册到租户

### 用户启用禁用

### 用户修改信息

### 用户导入

租户Tenant

### 租户注册

### 租户启用禁用

### 租户修改信息

### 绑定github组织

### 设置管理员

### 邀请用户

### 移除用户
